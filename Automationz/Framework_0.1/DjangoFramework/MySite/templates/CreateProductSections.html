{% extends "BaseTemplate.html" %} 
{% block title%} Create new product sections {%endblock%} 
{% block content %}

<script type="text/javascript" src="/site_media/Jquery/jstree/libs/jquery.js"></script>
<script type="text/javascript" src="/site_media/Jquery/jstree/jstree.min.js"></script>
<script type="text/javascript" src="/site_media/Jquery/Local/CreateProductSections.js"></script>
<link rel="stylesheet" href="/site_media/Jquery/bootstrap/css/bootstrap.min.css" />
<!-- <script type="text/javascript" src="/site_media/Jquery/jqtree/tree.jquery.js"></script> -->
<!-- <link rel="stylesheet" href="/site_media/Jquery/jqtree/jqtree.css"/> -->
<article>
    <div align="left">
        <h3 style="font-size: 19px;"><a style="font-weight: bold">View & Organize Test Cases</a></h3>
    </div>
	
	<script>
		function tree_create() {
			var ref = $('#jstree_container').jstree(true),
			sel = ref.get_selected();
			if(!sel.length) { return false; }
			sel = sel[0];
			console.log(sel);
			sel = ref.create_node(sel, {"type":"root"});
			if(sel) {
				ref.edit(sel);
				}
		};
		function tree_rename() {
			var ref = $('#jstree_container').jstree(true),
				sel = ref.get_selected();
			if(!sel.length) { return false; }
			sel = sel[0];
			ref.edit(sel);
		};
		function tree_delete() {
			var ref = $('#jstree_container').jstree(true),
				sel = ref.get_selected();
			if(!sel.length) { return false; }
			ref.delete_node(sel);
		};
	</script>

    <div class="responsive-tabs">
        <h3>View & Organize Test Cases</h3>
		<br /><br />
		<button type="button" class="btn btn-success btn-sm" onclick="tree_create();"><i class="glyphicon glyphicon-asterisk"></i> Create</button>
		<button type="button" class="btn btn-warning btn-sm" onclick="tree_rename();"><i class="glyphicon glyphicon-pencil"></i> Rename</button>
		<button type="button" class="btn btn-danger btn-sm" onclick="tree_delete();"><i class="glyphicon glyphicon-remove"></i> Delete</button>
		<input
			id="searchbox"
			value=""
			style="box-shadow:inset 0 0 4px #eee; width:120px; margin:0; padding:6px 12px; border-radius:4px; border:1px solid silver; font-size:1.1em;"
			type="text"
			placeholder="Search" >
		</input>
		<br /><br />
		
        <div class="tabs-div">
            <div id='jstree_container'>
				<ul>
				<li data-jstree='{"type" : "root"}'>Section
					<ul>				
						<li data-jstree='{"type" : "test_case"}' rel="tc">Run</li>
						<li rel="test_case">Manage</li>
						<li>View and Manage Test Cases</li>
					</ul>
				</li>
				<li data-jstree='{"type" : "root"}'>Shops
					<ul>
						<li>Future Shop
							<ul>Categories
								<li>Mobiles</li>
								<li>Laptops</li>
								<li>Routers</li>
							</ul>
						</li>
						<li>AS</li>
					</ul>
				</li>
			</ul>
            </div>
        </div>
        <h3>Create Product Sections</h3>
        <div class="tabs-div">
            <div id="enter_sections_text">
                <p>
                    Please Enter a name for the main section and its optional subsections.  These names will be used to group tests together.
                </p>
            </div>
            <br>

            <form id="section_names" action="ProductSectionsCreated/" method="POST">
                Main Section: <input type="text" class="main textbox" name="section_main"><br><br>
                Subsection 1: <input type="text" class="sub1 textbox" name="subsection_1"><br><br>
                Subsection 2: <input type="text" class="sub2 textbox" name="subsection_2"><br><br>
                Subsection 3: <input type="text" class="sub3 textbox" name="subsection_3"><br><br>
                Subsection 4: <input type="text" class="sub4 textbox" name="subsection_4"><br><br>
                <input type="submit" class="button minibutton primary" value="Submit"><br><br>
            </form>
        </div>
    </div>
    <script>
        var RESPONSIVEUI={};(function($){RESPONSIVEUI.responsiveTabs=function(){var $tabSets=$(".responsive-tabs");if(!$tabSets.hasClass("responsive-tabs--enabled")){$tabSets.addClass("responsive-tabs--enabled");var tablistcount=1;$tabSets.each(function(){var $tabs=$(this);$tabs.children(":header").addClass("responsive-tabs__heading");$tabs.children("div").addClass("responsive-tabs__panel");var $activePanel=$tabs.find(".responsive-tabs__panel--active");if(!$activePanel.length){$activePanel=$tabs.find(".responsive-tabs__panel").first().addClass("responsive-tabs__panel--active")}$tabs.find(".responsive-tabs__panel").not(".responsive-tabs__panel--active").hide().attr("aria-hidden","true");$activePanel.attr("aria-hidden","false");$activePanel.addClass("responsive-tabs__panel--closed-accordion-only");var $tabsWrapper=$("<div/>",{"class":"responsive-tabs-wrapper"});$tabs.wrap($tabsWrapper);var highestHeight=0;$tabs.find(".responsive-tabs__panel").each(function(){var tabHeight=$(this).height();if(tabHeight>highestHeight){highestHeight=tabHeight}});var $tabList=$("<ul/>",{"class":"responsive-tabs__list",role:"tablist"});var tabcount=1;$tabs.find(".responsive-tabs__heading").each(function(){var $tabHeading=$(this);var $tabPanel=$(this).next();$tabHeading.attr("tabindex",0);var $tabListItem=$("<li/>",{"class":"responsive-tabs__list__item",id:"tablist"+tablistcount+"-tab"+tabcount,"aria-controls":"tablist"+tablistcount+"-panel"+tabcount,role:"tab",tabindex:0,text:$tabHeading.text(),keydown:function(objEvent){if(objEvent.keyCode===13){$tabListItem.click()}},click:function(){$tabsWrapper.css("height",highestHeight);$tabs.find(".responsive-tabs__panel--closed-accordion-only").removeClass("responsive-tabs__panel--closed-accordion-only");$tabs.find(".responsive-tabs__panel--active").toggle().removeClass("responsive-tabs__panel--active").attr("aria-hidden","true").prev().removeClass("responsive-tabs__heading--active");$tabPanel.toggle().addClass("responsive-tabs__panel--active").attr("aria-hidden","false");$tabHeading.addClass("responsive-tabs__heading--active");$tabList.find(".responsive-tabs__list__item--active").removeClass("responsive-tabs__list__item--active");$tabListItem.addClass("responsive-tabs__list__item--active");$tabsWrapper.css("height","auto")}});$tabPanel.attr({role:"tabpanel","aria-labelledby":$tabListItem.attr("id"),id:"tablist"+tablistcount+"-panel"+tabcount});if($tabPanel.hasClass("responsive-tabs__panel--active")){$tabListItem.addClass("responsive-tabs__list__item--active")}$tabList.append($tabListItem);$tabHeading.keydown(function(objEvent){if(objEvent.keyCode===13){$tabHeading.click()}});$tabHeading.click(function(){$tabs.find(".responsive-tabs__panel--closed-accordion-only").removeClass("responsive-tabs__panel--closed-accordion-only");if(!$tabHeading.hasClass("responsive-tabs__heading--active")){var oldActivePos,$activeHeading=$tabs.find(".responsive-tabs__heading--active");if($activeHeading.length){oldActivePos=$activeHeading.offset().top}$tabs.find(".responsive-tabs__panel--active").slideToggle().removeClass("responsive-tabs__panel--active").prev().removeClass("responsive-tabs__heading--active");$tabs.find(".responsive-tabs__panel").hide().attr("aria-hidden","true");$tabPanel.slideToggle().addClass("responsive-tabs__panel--active").attr("aria-hidden","false");$tabHeading.addClass("responsive-tabs__heading--active");var $currentActive=$tabs.find(".responsive-tabs__list__item--active");$currentActive.removeClass("responsive-tabs__list__item--active");var panelId=$tabPanel.attr("id");var tabId=panelId.replace("panel","tab");$("#"+tabId).addClass("responsive-tabs__list__item--active");var tabsPos=$tabs.offset().top;var newActivePos=($tabHeading.offset().top)-15;if(oldActivePos<newActivePos){$("html, body").animate({scrollTop:tabsPos},0).animate({scrollTop:newActivePos},400)}}else{$tabPanel.removeClass("responsive-tabs__panel--active").slideToggle(function(){$(this).addClass("responsive-tabs__panel--closed-accordion-only")});$tabHeading.removeClass("responsive-tabs__heading--active")}});tabcount++});$tabs.prepend($tabList);tablistcount++})}}})(jQuery);
    </script>
    <script>
        $(document).ready(function() {
            RESPONSIVEUI.responsiveTabs();
			
			// jsTree --------------------------------------
			$("#jstree_container").jstree({
				"core" : {
					"themes" : { "stripes" : true, "variant" : "large" },
				
					// what operations are allowed on the tree items
					"check_callback" : true
				},
				"types" : {
					"#": {
						"valid_children" : ["root"]
					},
					"root" : {
						"valid_children" : ["test_case"],
						"icon" : "glyphicon glyphicon-list-alt"
					},
					"test_case" : {
						"max_children" : 0,
						"max_depth" : 0,
						"icon" : "glyphicon glyphicon-tag",
						"delete_node" : false
					}
				},
				"plugins" : [
					"checkbox",					// enable check box
					"contextmenu",				// enable context menu
					// "dnd",					// drag and drop
					"search",					// enable search
					"wholerow",					// enable clicking on the whole border(box model)
					"unique",					// enforces that no nodes with the same name can co-exist as siblings
					// "state"					// enables saving current tree state
					"types"						// enable customisation of different nodes
				]
			}).bind("before.jstree", function(e, data) {
				console.log(data);
				
				/*
				if (data.node.children.length === 0) {
					console.log("The current node has no children, so it is deletable.");
					return true;
				} else {
					console.log("The current node has no children, so it is deletable.");
					alert("Sorry, you cannot delete a non-empty section!");
					e.stopImmediatePropagation();
					return false;
				} */
			});
			
			// Enable the search feature
			var to = false;
			$("#searchbox").keyup(function() {
				if (to) { clearTimeout(to); }
				
				// Here we're using a timeout so that the search is done after
				// a specified amount of time rather than on every key stroke
				// NOTE: Raise the value if the browser slows down during search
				to = setTimeout(function() {
					var v = $("#searchbox").val();
					
					$("#jstree_container").jstree(true).search(v);
				}, 250);
			});
        });
    </script>
</article>
{% endblock %}
